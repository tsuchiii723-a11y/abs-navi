async function saveLog() {
    const btn = document.getElementById('saveBtn');
    // すべての切削条件を確実に収集します
    const data = {
        toolName: document.getElementById('tool').options[document.getElementById('tool').selectedIndex].text,
        d: document.getElementById('tool').value,
        process: currentProcess === 'rough' ? '荒削り' : '仕上げ',
        mode: currentMode === 'normal' ? '通常' : '加速',
        f: document.getElementById('rf').innerText.replace(/,/g, ''),
        s: document.getElementById('rs').innerText.replace(/,/g, ''),
        c: document.getElementById('rc').innerText,
        p: document.getElementById('rp').innerText,
        m: document.getElementById('rm').innerText,
        res: document.getElementById('res_status').value,
        memo: document.getElementById('memo').value || "-"
    };
    
    btn.disabled = true;
    btn.innerText = "送信中...";
    
    try {
        const response = await fetch(API_URL, {
            method: "POST",
            mode: "no-cors", // 通信エラーを防ぐための設定
            body: JSON.stringify(data)
        });
        document.getElementById('memo').value = "";
        btn.innerText = "送信完了";
        loadLogs();
    } catch (e) {
        alert("送信エラーが発生しました。");
    }
    setTimeout(() => { btn.disabled = false; btn.innerText = "結果をクラウドに送信"; }, 2000);
}
